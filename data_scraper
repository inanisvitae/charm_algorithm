import praw
import pandas as pd


reddit = praw.Reddit(client_id="XdEnLPkLpMETVw",  # my client id
                     client_secret="YLeYBcQN6NL9ZH7CipCVmqisfZu8aw",  # your client secret
                     user_agent="Reddit:Data_Scraper:0.1 (by /u/Mysterious_Middle690)",  # user agent name
                     username="mysterious_middle690",  # your reddit username
                     password="Mysterious_Middle690")  # your reddit password

sub = ['Wallstreetbets']

for s in sub:
    subreddit = reddit.subreddit(s)
    post_dict = {
        "title": [],
        "score": [],
        "id": [],
        "url": [],
        "comms_num": [],
        "created": [],
        "body": []
    }
    comments_dict = {
        "comment_id": [],
        "comment_parent_id": [],
        "comment_body": [],
        "comment_link_id": []
    }
    for submission in subreddit.new(limit=5):
        post_dict["title"].append(submission.title)
        post_dict["score"].append(submission.score)
        post_dict["id"].append(submission.id)
        post_dict["url"].append(submission.url)
        post_dict["comms_num"].append(submission.num_comments)
        post_dict["created"].append(submission.created)
        post_dict["body"].append(submission.selftext)

        submission.comments.replace_more(limit=1)
        for comment in submission.comments.list():
            comments_dict["comment_id"].append(comment.id)
            comments_dict["comment_parent_id"].append(comment.parent_id)
            comments_dict["comment_body"].append(comment.body)
            comments_dict["comment_link_id"].append(comment.link_id)

    post_comments = pd.DataFrame(comments_dict)

    post_comments.to_csv(s + "_comments_" + 'Wallstreetbets' + "subreddit.csv")
    post_data = pd.DataFrame(post_dict)
    post_data.to_csv(s + "_" + 'Wallstreetbets' + "subreddit.csv")

